@model DanzFloor.Web.Models.ViewModels.ArticuloPedidoViewModel

@using (Html.BeginForm("Create", "ArticuloPedido", FormMethod.Post, new { id = "agregar-articulo"}))
{
    <div class="modal-body">
        @Html.AntiForgeryToken()
        @Html.ValidationSummary(true, "", new { @class = "text-danger" })
        @Html.HiddenFor(x => x.PedidoId)
        @Html.HiddenFor(x => x.AgregarOtro)
        <div class="row">

            <div class="col-md-6 form-group fg-float m-t-0 m-b-0">
                <label>Artículo</label>
                <div class="fg-line">
                    <select class="chosen" id="ArticuloSelected" name="ArticuloSelected">
                        @if (Model.ListaArticulos != null)
                        {
                            foreach (var item in Model.ListaArticulos)
                            {
                                <option value="@item.Id">@item.Nombre</option>
                            }
                        }
                    </select>
                </div>
            </div>

            <div class="col-md-6 form-group fg-float m-t-25 m-b-0">
                <div class="fg-line">
                    @Html.EditorFor(model => model.Cantidad, new { htmlAttributes = new { @class = "form-control input-sm" } })
                    @Html.ValidationMessageFor(model => model.Cantidad, "", new { @class = "text-danger" })
                    @Html.LabelFor(model => model.Cantidad, new { @class = "fg-label" })
                </div>
            </div>
        </div>
    </div>
    <div class="modal-footer">
        <section botones-validos style="display:none">
            <a articulo-pedido-guardar id="btnGuardar" class="btn btn-link ">Guardar</a>
            <a articulo-pedido-guardar-agregar id="btnGuardarAgregar" class="btn btn-link ">Guardar y agregar</a>
        </section>

        <section botones-deshabilitados>
            <a disabled="true" class="btn btn-link ">Guardar</a>
            <a disabled="true" class="btn btn-link ">Guardar y agregar</a>
        </section>

        <button type="button" class="btn btn-link" data-dismiss="modal">
            Cerrar
        </button>
    </div>
}

<script type="text/javascript">
    var validarFormulario = function () {
        var guidEmpty = '@Guid.Empty';
        var articuloId = $('#ArticuloSelected').val();
        
        return parseInt($('#Cantidad').val()) > 0;
    }

    $(document).ready(function () {
        $('[articulo-pedido-guardar]').click(function () {

            if (validarFormulario())
            {
                $('#AgregarOtro').val('false');
                $('form#agregar-articulo').submit();
            }
        });

        $('[articulo-pedido-guardar-agregar]').click(function () {

            if (validarFormulario()) {
                $('#AgregarOtro').val('true');
                $('form#agregar-articulo').submit();
            }
        });
    });
    $('#Cantidad').change(function () {

        if (validarFormulario()) {
            $('[botones-deshabilitados]').hide();
            $('[botones-validos]').show();
        }
        else
        {
            $('[botones-deshabilitados]').show();
            $('[botones-validos]').hide();
        }
    });
</script>
